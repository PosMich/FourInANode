<!doctype html>
<html lang="de">
<head>
    <meta charset="utf-8" />
    <title>Four In A Node</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
    <script src="http://localhost:8080/socket.io/socket.io.js"></script>
    <!--[if IE]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script>
        var socket = io.connect('http://localhost:8080');

        socket.on("update player name successful", function( data ) {
            console.log("new name successfully set to: "+data);
        });

        socket.on("update player name failed", function() { alert("player name update failed");});

        socket.on("game start successful", function() {console.log("game started")});

        socket.emit("get player name");

        socket.on("player name", function (data) {
          console.log("player name: " + data);
        })

        socket.on("update opponent list", function( data ) {
          console.log(data);
          var html = "<table>";
          for (var i=0; i<data.length; i++) {
            html += "<tr><td class=\"clientname\">Clientname: "+data[i].clientname+"</td><td class=\"ip\">IP: "+data[i].ip+"</td><td class=\"keepalive\">Keepalive: "+data[i].keepalive+"</td><td><a href=\"#\" id=\""+i+"\" class=\"playwith\">Play with me!</a></td></tr>";
          }
          $("#found").html(html);
          $(".playwith").each(function() {
              $(this).click( function(e) {
                e.preventDefault();
                console.log("send game request");
                socket.emit("send game request", $(this).parent().parent().find(".clientname").html());
              });
          });
        });

        socket.on("play request accepted", function( data ) {
          
        }
  </script>
  <script type="css">
  :invalid {
    border: 2px solid #ff0000;
  }
  </script>
</head>
<body>
  <p><a href="#" id="startfsm">Start state machine</a></p>
  <p>
    <input type="text" id="player_name" placeholder="Mein Name">
    <a href="#" id="player">Name &auml;ndern</a>
  </p>
  <p><a href="#" id="start">Start searching</a></p>
  <div id="found"></div>
</body>
<script>
$(document).ready(function(){
    $("#player").click( function(e) {
        e.preventDefault();
        console.log("trying to set new player name " + $("#player_name").val());
        socket.emit("set player name", $("#player_name").val() );
    });
    $("#start").click( function(e) {
        e.preventDefault();
        console.log("trying to start game");
        socket.emit("start searching opponents");
    })
    $("#startfsm").click( function(e) {
        e.preventDefault();
        console.log("trying to start state machine");
        socket.emit("start game with", "Player 1");
    })
});
</script>
</html>